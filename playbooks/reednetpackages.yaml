# yaml-language-server: $schema=https://github.com/ansible/ansible-lint/raw/refs/heads/main/src/ansiblelint/schemas/playbook.json
- name: Install reednet-specific software
  hosts: all
  tasks:
    - name: Install poly-authelia-users-from-shadow
      become: true
      ansible.builtin.copy:
        src: '../scripts/authelia-users-from-shadow.py'
        dest: '/usr/local/bin/poly-authelia-users-from-shadow'
        group: 'root'
        owner: 'root'
        mode: '555'

    - name: Install poly-shadow-substitute-hash
      become: true
      ansible.builtin.copy:
        src: '../scripts/shadow-substitute-hash.py'
        dest: '/usr/local/bin/poly-shadow-substitute-hash'
        group: 'root'
        owner: 'root'
        mode: '555'

    - name: Install poly-shadow-syncd
      become: true
      ansible.builtin.copy:
        src: '../scripts/shadow-syncd.py'
        dest: '/usr/local/bin/poly-shadow-syncd'
        group: 'root'
        owner: 'root'
        mode: '555'

    - name: Install pwchange
      become: true
      ansible.builtin.copy:
        src: '../passwidget/pwchange'
        dest: '/usr/local/bin/pwchange'
        group: 'root'
        owner: 'root'
        mode: 'u=rxs,g=rx,o=rx'

    - name: Install pwwidget
      become: true
      ansible.builtin.copy:
        src: '../passwidget/pwwidget'
        dest: '/usr/local/bin/pwwidget'
        group: 'root'
        owner: 'root'
        mode: 'u=rx,g=rx,o=rx'
